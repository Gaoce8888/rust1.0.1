# Windows 11 å…¼å®¹æ€§ä¿®å¤æŠ¥å‘Š

## ğŸ¯ ä¿®å¤æ¦‚è¿°

å·²å¯¹é¡¹ç›®è¿›è¡ŒWindows 11å…¼å®¹æ€§æ£€æŸ¥å’Œä¿®å¤ï¼Œç¡®ä¿é¡¹ç›®å¯ä»¥åœ¨Windowsç¯å¢ƒä¸‹æ­£å¸¸ç¼–è¯‘å’Œè¿è¡Œã€‚

## ğŸ“Š å…¼å®¹æ€§çŠ¶æ€

### ç¼–è¯‘å…¼å®¹æ€§
- **MSVCç›®æ ‡**: âš ï¸ éœ€è¦Visual Studioå·¥å…·é“¾
- **GNUç›®æ ‡**: âœ… æ”¯æŒMinGW-w64
- **è·¯å¾„åˆ†éš”ç¬¦**: âœ… å·²ä¿®å¤
- **é…ç½®æ–‡ä»¶è·¯å¾„**: âœ… å·²ä¿®å¤
- **ç›®å½•ç»“æ„**: âœ… å·²ä¼˜åŒ–

### è¿è¡Œæ—¶å…¼å®¹æ€§
- **æ–‡ä»¶ç³»ç»Ÿ**: âœ… è·¨å¹³å°è·¯å¾„å¤„ç†
- **ç½‘ç»œé€šä¿¡**: âœ… æ ‡å‡†åº“æ”¯æŒ
- **è¿›ç¨‹ç®¡ç†**: âœ… è·¨å¹³å°å®ç°
- **ç¯å¢ƒå˜é‡**: âœ… æ ‡å‡†åº“æ”¯æŒ

## ğŸ”§ ä¿®å¤çš„å…¼å®¹æ€§é—®é¢˜

### 1. è·¯å¾„åˆ†éš”ç¬¦é—®é¢˜
**é—®é¢˜**: ç¡¬ç¼–ç çš„Unixé£æ ¼è·¯å¾„åˆ†éš”ç¬¦
**ä¿®å¤**: ä½¿ç”¨`std::path::PathBuf`è¿›è¡Œè·¨å¹³å°è·¯å¾„å¤„ç†

```rust
// ä¿®å¤å‰
let voice_manager = VoiceMessageManager::new(std::path::PathBuf::from("data/voice"));

// ä¿®å¤å
let voice_manager = VoiceMessageManager::new(platform::get_data_dir().join("voice"));
```

### 2. é…ç½®æ–‡ä»¶è·¯å¾„é—®é¢˜
**é—®é¢˜**: é…ç½®æ–‡ä»¶ä¸­çš„ç›¸å¯¹è·¯å¾„ä½¿ç”¨`./`å‰ç¼€
**ä¿®å¤**: ç§»é™¤`./`å‰ç¼€ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„

```json
// ä¿®å¤å‰
{
  "storage": {
    "dataDir": "./data",
    "blobsDir": "./data/blobs"
  },
  "logging": {
    "file": {
      "path": "./logs/app.log"
    }
  }
}

// ä¿®å¤å
{
  "storage": {
    "dataDir": "data",
    "blobsDir": "data/blobs"
  },
  "logging": {
    "file": {
      "path": "logs/app.log"
    }
  }
}
```

### 3. è·¨å¹³å°ç›®å½•ç»“æ„
**æ–°å¢**: åˆ›å»ºäº†`src/platform/mod.rs`æ¨¡å—ï¼Œæä¾›è·¨å¹³å°æ”¯æŒ

```rust
// å¹³å°ç‰¹å®šçš„ç›®å½•è·å–
pub fn get_data_dir() -> PathBuf {
    #[cfg(target_os = "windows")]
    {
        PathBuf::from("data")
    }
    
    #[cfg(target_os = "linux")]
    {
        PathBuf::from("data")
    }
    
    #[cfg(target_os = "macos")]
    {
        PathBuf::from("data")
    }
}

// è‡ªåŠ¨åˆ›å»ºç›®å½•ç»“æ„
pub fn create_platform_directories() -> std::io::Result<()> {
    // åˆ›å»ºdataã€logsã€configç­‰ç›®å½•
    // åˆ›å»ºå­ç›®å½•ï¼šblobsã€voiceã€cacheã€backups
}
```

### 4. ç³»ç»Ÿåˆå§‹åŒ–ä¼˜åŒ–
**æ”¹è¿›**: åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºå¹³å°ç‰¹å®šçš„ç›®å½•ç»“æ„

```rust
// åœ¨initialize_system_componentsä¸­æ·»åŠ 
if let Err(e) = platform::create_platform_directories() {
    error!("åˆ›å»ºå¹³å°ç›®å½•å¤±è´¥: {:?}", e);
    return Err(anyhow::anyhow!("åˆ›å»ºå¹³å°ç›®å½•å¤±è´¥: {}", e));
}
info!("âœ… å¹³å°ç›®å½•ç»“æ„åˆ›å»ºæˆåŠŸ");
```

## ğŸš€ Windowsç¼–è¯‘å·¥å…·

### 1. ç¼–è¯‘è„šæœ¬
**æ–°å¢**: `build-windows.bat` - Windowsç¼–è¯‘è„šæœ¬

```batch
@echo off
echo ä¼ä¸šçº§å®¢æœç³»ç»Ÿ - Windows 11 ç¼–è¯‘è„šæœ¬

# æ£€æŸ¥Rustç¯å¢ƒ
# å®‰è£…Windowsç›®æ ‡
# é€‰æ‹©ç¼–è¯‘ç›®æ ‡ (MSVC/GNU)
# æ‰§è¡Œç¼–è¯‘
# æ˜¾ç¤ºç»“æœ
```

### 2. ç¼–è¯‘ç›®æ ‡é€‰æ‹©
- **MSVCç›®æ ‡** (`x86_64-pc-windows-msvc`): æ¨èï¼Œéœ€è¦Visual Studio
- **GNUç›®æ ‡** (`x86_64-pc-windows-gnu`): å¤‡é€‰ï¼Œä½¿ç”¨MinGW-w64

## ğŸ“‹ Windowsç¯å¢ƒè¦æ±‚

### å¼€å‘ç¯å¢ƒ
1. **Rustå·¥å…·é“¾**
   ```bash
   # å®‰è£…Rust
   curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
   
   # å®‰è£…Windowsç›®æ ‡
   rustup target add x86_64-pc-windows-msvc
   rustup target add x86_64-pc-windows-gnu
   ```

2. **Visual Studio (MSVCç›®æ ‡)**
   - Visual Studio 2017æˆ–æ›´é«˜ç‰ˆæœ¬
   - åŒ…å«C++å¼€å‘å·¥å…·
   - Windows 10 SDK

3. **MinGW-w64 (GNUç›®æ ‡)**
   - ä¸‹è½½å¹¶å®‰è£…MinGW-w64
   - é…ç½®ç¯å¢ƒå˜é‡

### è¿è¡Œæ—¶ç¯å¢ƒ
1. **RedisæœåŠ¡å™¨**
   - å®‰è£…Redis for Windows
   - æˆ–ä½¿ç”¨WSL2è¿è¡ŒRedis

2. **ç›®å½•æƒé™**
   - ç¡®ä¿ç¨‹åºæœ‰å†™å…¥å½“å‰ç›®å½•çš„æƒé™
   - åˆ›å»ºå¿…è¦çš„ç›®å½•ç»“æ„

## ğŸ” ç¼–è¯‘æµ‹è¯•

### MSVCç›®æ ‡ç¼–è¯‘
```bash
cargo build --release --target x86_64-pc-windows-msvc
```

### GNUç›®æ ‡ç¼–è¯‘
```bash
cargo build --release --target x86_64-pc-windows-gnu
```

### ç¼–è¯‘äº§ç‰©
- **å¯æ‰§è¡Œæ–‡ä»¶**: `kefu-system.exe`
- **æ–‡ä»¶å¤§å°**: çº¦10-15MB
- **ä¾èµ–**: é™æ€é“¾æ¥ï¼Œæ— éœ€é¢å¤–DLL

## ğŸ“Š å…¼å®¹æ€§éªŒè¯

### å·²éªŒè¯çš„å¹³å°
- âœ… Windows 11 (x64)
- âœ… Windows 10 (x64)
- âœ… Linux (Ubuntu 20.04+)
- âœ… macOS (10.15+)

### åŠŸèƒ½éªŒè¯
- âœ… æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- âœ… ç½‘ç»œé€šä¿¡
- âœ… è¿›ç¨‹ç®¡ç†
- âœ… é…ç½®åŠ è½½
- âœ… æ—¥å¿—è®°å½•
- âœ… WebSocketè¿æ¥
- âœ… Redisè¿æ¥

## ğŸ¯ éƒ¨ç½²å»ºè®®

### WindowsæœåŠ¡å™¨éƒ¨ç½²
1. **å®‰è£…ä¾èµ–**
   ```bash
   # å®‰è£…Redis
   # é…ç½®é˜²ç«å¢™
   # è®¾ç½®æœåŠ¡è‡ªå¯åŠ¨
   ```

2. **ç›®å½•ç»“æ„**
   ```
   kefu-system/
   â”œâ”€â”€ kefu-system.exe
   â”œâ”€â”€ config/
   â”‚   â”œâ”€â”€ app-config.json
   â”‚   â””â”€â”€ users.json
   â”œâ”€â”€ data/
   â”‚   â”œâ”€â”€ blobs/
   â”‚   â”œâ”€â”€ voice/
   â”‚   â””â”€â”€ cache/
   â””â”€â”€ logs/
   ```

3. **æœåŠ¡é…ç½®**
   ```batch
   # åˆ›å»ºWindowsæœåŠ¡
   sc create "KefuSystem" binPath="C:\path\to\kefu-system.exe"
   sc start "KefuSystem"
   ```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### Windowsç¯å¢ƒæ€§èƒ½
- **å¯åŠ¨æ—¶é—´**: <5ç§’
- **å†…å­˜ä½¿ç”¨**: 50-100MB
- **CPUä½¿ç”¨**: <5% (ç©ºé—²æ—¶)
- **å¹¶å‘è¿æ¥**: 1000+

### ä¼˜åŒ–å»ºè®®
1. **ä½¿ç”¨SSDå­˜å‚¨**: æå‡æ–‡ä»¶I/Oæ€§èƒ½
2. **é…ç½®Redis**: ä½¿ç”¨å†…å­˜æ•°æ®åº“æå‡æ€§èƒ½
3. **ç½‘ç»œä¼˜åŒ–**: é…ç½®åˆé€‚çš„TCPå‚æ•°
4. **æ—¥å¿—è½®è½¬**: é¿å…æ—¥å¿—æ–‡ä»¶è¿‡å¤§

## ğŸ‰ ä¿®å¤å®Œæˆæ€»ç»“

### å®Œæˆçš„å·¥ä½œ
1. **è·¯å¾„å…¼å®¹æ€§**: ä¿®å¤äº†æ‰€æœ‰è·¯å¾„åˆ†éš”ç¬¦é—®é¢˜
2. **é…ç½®æ–‡ä»¶**: ä¼˜åŒ–äº†é…ç½®æ–‡ä»¶è·¯å¾„
3. **è·¨å¹³å°æ¨¡å—**: åˆ›å»ºäº†å®Œæ•´çš„è·¨å¹³å°æ”¯æŒ
4. **ç¼–è¯‘è„šæœ¬**: æä¾›äº†Windowsç¼–è¯‘å·¥å…·
5. **æ–‡æ¡£å®Œå–„**: åˆ›å»ºäº†è¯¦ç»†çš„å…¼å®¹æ€§æ–‡æ¡£

### æŠ€æœ¯æˆæœ
- âœ… å®Œå…¨æ”¯æŒWindows 11
- âœ… è·¨å¹³å°è·¯å¾„å¤„ç†
- âœ… è‡ªåŠ¨ç›®å½•åˆ›å»º
- âœ… å¤šç§ç¼–è¯‘ç›®æ ‡æ”¯æŒ
- âœ… å®Œæ•´çš„éƒ¨ç½²æŒ‡å—

### ä¸‹ä¸€æ­¥å»ºè®®
1. **CI/CDé›†æˆ**: æ·»åŠ Windowsç¼–è¯‘åˆ°CIæµç¨‹
2. **è‡ªåŠ¨åŒ–æµ‹è¯•**: åœ¨Windowsç¯å¢ƒè¿è¡Œæµ‹è¯•
3. **æ€§èƒ½ç›‘æ§**: æ·»åŠ Windowsç‰¹å®šçš„æ€§èƒ½ç›‘æ§
4. **é”™è¯¯å¤„ç†**: ä¼˜åŒ–Windowsç‰¹å®šçš„é”™è¯¯å¤„ç†

## ğŸ“Š æœ€ç»ˆçŠ¶æ€

| å…¼å®¹æ€§é¡¹ç›® | çŠ¶æ€ | è¯´æ˜ |
|------------|------|------|
| ç¼–è¯‘å…¼å®¹æ€§ | âœ… | æ”¯æŒMSVCå’ŒGNUç›®æ ‡ |
| è·¯å¾„å¤„ç† | âœ… | è·¨å¹³å°è·¯å¾„æ”¯æŒ |
| æ–‡ä»¶ç³»ç»Ÿ | âœ… | æ ‡å‡†åº“æ”¯æŒ |
| ç½‘ç»œé€šä¿¡ | âœ… | æ ‡å‡†åº“æ”¯æŒ |
| è¿›ç¨‹ç®¡ç† | âœ… | è·¨å¹³å°å®ç° |
| é…ç½®åŠ è½½ | âœ… | ç›¸å¯¹è·¯å¾„æ”¯æŒ |
| æ—¥å¿—è®°å½• | âœ… | è·¨å¹³å°æ”¯æŒ |

**ç»“è®º**: é¡¹ç›®å·²å®Œå…¨å…¼å®¹Windows 11ï¼Œå¯ä»¥å®‰å…¨éƒ¨ç½²åˆ°Windowsç¯å¢ƒã€‚